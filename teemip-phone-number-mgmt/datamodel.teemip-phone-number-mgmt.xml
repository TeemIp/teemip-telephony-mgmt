<?xml version="1.0" encoding="UTF-8"?>
<itop_design xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="3.2" load="strict">
    <classes>
        <class id="PNObject" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <properties>
                <comment/>
                <category>bizmodel,pnmgmt</category>
                <abstract>true</abstract>
                <key_type>autoincrement</key_type>
                <db_table>pnobject</db_table>
                <db_key_field>id</db_key_field>
                <db_final_class_field>finalclass</db_final_class_field>
                <naming>
                    <attributes/>
                </naming>
                <icon/>
                <reconciliation>
                    <attributes>
                        <attribute id=""/>
                    </attributes>
                </reconciliation>
            </properties>
            <fields>
                <field id="org_id" xsi:type="AttributeExternalKey">
                    <sql>org_id</sql>
                    <target_class>Organization</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                    <jointype/>
                </field>
                <field id="org_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>org_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="status" xsi:type="AttributeEnum">
                    <sort_type>rank</sort_type>
                    <values>
                        <value id="reserved">
                            <code>reserved</code>
                            <rank>10</rank>
                            <style>
                                <main_color>hsla(0, 60.8%, 48%, 1)</main_color>
                                <complementary_color>hsla(0, 0%, 100%, 1)</complementary_color>
                                <decoration_classes/>
                            </style>
                        </value>
                        <value id="allocated">
                            <code>allocated</code>
                            <rank>20</rank>
                            <style>
                                <main_color>hsla(207, 72.6%, 57.1%, 1)</main_color>
                                <complementary_color>hsla(0, 0%, 100%, 1)</complementary_color>
                                <decoration_classes/>
                            </style>
                        </value>
                        <value id="released">
                            <code>released</code>
                            <rank>30</rank>
                            <style>
                                <main_color>hsla(209, 23.7%, 74.3%, 1)</main_color>
                                <complementary_color>hsla(0, 0%, 100%, 1)</complementary_color>
                                <decoration_classes/>
                            </style>
                        </value>
                        <value id="unassigned">
                            <code>unassigned</code>
                            <rank>40</rank>
                            <style>
                                <main_color>hsla(88, 50.2%, 52.7%, 1)</main_color>
                                <complementary_color>hsla(0, 0%, 100%, 1)</complementary_color>
                                <decoration_classes/>
                            </style>
                        </value>
                    </values>
                    <default_style>
                        <main_color>hsla(88, 50.2%, 52.7%, 1)</main_color>
                        <complementary_color>hsla(0, 0%, 100%, 1)</complementary_color>
                        <decoration_classes/>
                    </default_style>
                    <sql>status</sql>
                    <default_value>allocated</default_value>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="comment" xsi:type="AttributeText">
                    <sql>comment</sql>
                    <default_value/>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="requestor_id" xsi:type="AttributeExternalKey">
                    <sql>requestor_id</sql>
                    <target_class>Person</target_class>
                    <filter><![CDATA[SELECT Person AS p WHERE p.org_id = :this->org_id]]></filter>
                    <dependencies>
                        <attribute id="org_id"/>
                    </dependencies>
                    <is_null_allowed>true</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                    <jointype/>
                </field>
                <field id="requestor_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>requestor_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="allocation_date" xsi:type="AttributeDateTime">
                    <sql>allocation_date</sql>
                    <default_value/>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="release_date" xsi:type="AttributeDateTime">
                    <sql>release_date</sql>
                    <default_value/>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="contacts_list" xsi:type="AttributeLinkedSetIndirect">
                    <linked_class>lnkContactToPNObject</linked_class>
                    <ext_key_to_me>pnobject_id</ext_key_to_me>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                    <ext_key_to_remote>contact_id</ext_key_to_remote>
                    <duplicates/>
                </field>
                <field id="documents_list" xsi:type="AttributeLinkedSetIndirect">
                    <linked_class>lnkDocToPNObject</linked_class>
                    <ext_key_to_me>pnobject_id</ext_key_to_me>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                    <ext_key_to_remote>document_id</ext_key_to_remote>
                    <duplicates/>
                </field>
                <field id="tickets_list" xsi:type="AttributeLinkedSetIndirect">
                    <linked_class>lnkPNObjectToTicket</linked_class>
                    <ext_key_to_me>pnobject_id</ext_key_to_me>
                    <count_min>0</count_min>
                    <count_max>0</count_max>
                    <ext_key_to_remote>ticket_id</ext_key_to_remote>
                    <duplicates/>
                </field>
            </fields>
            <event_listeners>
                <event_listener id="OnPNObjectBeforeWriteRequestedByPNObject">
                    <event>EVENT_DB_BEFORE_WRITE</event>
                    <callback>OnPNObjectBeforeWriteRequestedByPNObject</callback>
                    <rank>100</rank>
                </event_listener>
            </event_listeners>
            <methods>
                <method id="OnPNObjectBeforeWriteRequestedByPNObject">
                    <comment/>
                    <static>false</static>
                    <access>public</access>
                    <type>EventListener</type>
                    <code><![CDATA[    public function OnPNObjectBeforeWriteRequestedByPNObject(Combodo\iTop\Service\Events\EventData $oEventData)
    {
        $aEventData = $oEventData->GetEventData();
        if ($aEventData['is_new']) {
    		// Set allocation and released date as required
    		$sStatus = $this->Get('status');
	    	if ($sStatus == 'allocated') {
		    	$this->Set('allocation_date', time());
    		} elseif ($sStatus== 'released') {
	    		$this->Set('release_date', time());
		    }
		} else {
            // Set allocation and released date as required
            $sStatus = $this->Get('status');
            $soriginalStatus = $this->GetOriginal('status');
            if (($sStatus == 'allocated') && ($soriginalStatus != 'allocated')) {
                $this->Set('allocation_date', time());
            } elseif (($sStatus== 'released') && ($soriginalStatus != 'released')) {
                $this->Set('release_date', time());
             }
		}
    }]]></code>
                </method>
                <method id="ComputeValues">
                    <comment/>
                    <static>false</static>
                    <access>protected</access>
                    <type>Overload-cmdbAbstractObject</type>
                    <code><![CDATA[ public function ComputeValues()
 {
 		parent::ComputeValues();

		if ($this->IsNew()) {
			// Make sure IPConfig exists for the organization
			//$iOrgId = $this->Get('org_id');
			//if (($iOrgId != '') && ($this->Get('ipconfig_id') == '')) {
			//	$this->Set('ipconfig_id', IPConfig::GetGlobalIPConfig($iOrgId)->GetKey());
			//}
		}
 }]]></code>
                </method>
            </methods>
            <presentation>
                <list>
                    <items>
                        <item id="finalclass">
                            <rank>10</rank>
                        </item>
                        <item id="org_id">
                            <rank>20</rank>
                        </item>
                        <item id="status">
                            <rank>30</rank>
                        </item>
                        <item id="requestor_id">
                            <rank>40</rank>
                        </item>
                        <item id="allocation_date">
                            <rank>50</rank>
                        </item>
                        <item id="release_date">
                            <rank>60</rank>
                        </item>
                    </items>
                </list>
                <default_search>
                    <items>
                        <item id="org_id">
                            <rank>10</rank>
                        </item>
                        <item id="status">
                            <rank>20</rank>
                        </item>
                        <item id="requestor_id">
                            <rank>30</rank>
                        </item>
                        <item id="allocation_date">
                            <rank>40</rank>
                        </item>
                        <item id="release_date">
                            <rank>50</rank>
                        </item>
                    </items>
                </default_search>
            </presentation>
        </class>
        <class id="lnkContactToPNObject" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <properties>
                <is_link>1</is_link>
                <category>bizmodel,pnmgmt</category>
                <abstract>false</abstract>
                <key_type>autoincrement</key_type>
                <db_table>lnkcontacttopnobject</db_table>
                <db_key_field>id</db_key_field>
                <db_final_class_field/>
                <naming>
                    <attributes>
                        <attribute id="pnobject_id"/>
                        <attribute id="contact_name"/>
                    </attributes>
                </naming>
                <icon/>
                <reconciliation>
                    <attributes>
                        <attribute id="pnobject_id"/>
                        <attribute id="contact_id"/>
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="pnobject_id"/>
                            <attribute id="contact_id"/>
                        </attributes>
                        <filter><![CDATA[]]></filter>
                        <disabled>false</disabled>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="pnobject_id" xsi:type="AttributeExternalKey">
                    <sql>pnobject_id</sql>
                    <target_class>PNObject</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                    <jointype/>
                </field>
                <field id="contact_id" xsi:type="AttributeExternalKey">
                    <sql>contact_id</sql>
                    <target_class>Contact</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                    <jointype/>
                </field>
                <field id="contact_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>contact_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
            </fields>
            <methods/>
            <presentation>
                <details>
                    <items>
                        <item id="pnobject_id">
                            <rank>10</rank>
                        </item>
                        <item id="contact_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </details>
                <search>
                    <items>
                        <item id="pnobject_id">
                            <rank>10</rank>
                        </item>
                        <item id="contact_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="pnobject_id">
                            <rank>10</rank>
                        </item>
                        <item id="contact_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="lnkDocToPNObject" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <properties>
                <is_link>1</is_link>
                <category>bizmodel,pnmgmt</category>
                <abstract>false</abstract>
                <key_type>autoincrement</key_type>
                <db_table>lnkdoctopnobject</db_table>
                <db_key_field>id</db_key_field>
                <db_final_class_field/>
                <naming>
                    <attributes>
                        <attribute id="pnobject_id"/>
                        <attribute id="document_name"/>
                    </attributes>
                </naming>
                <icon/>
                <reconciliation>
                    <attributes>
                        <attribute id="pnobject_id"/>
                        <attribute id="document_id"/>
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="pnobject_id"/>
                            <attribute id="document_id"/>
                        </attributes>
                        <filter><![CDATA[]]></filter>
                        <disabled>false</disabled>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="pnobject_id" xsi:type="AttributeExternalKey">
                    <sql>pnobject_id</sql>
                    <target_class>PNObject</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                    <jointype/>
                </field>
                <field id="document_id" xsi:type="AttributeExternalKey">
                    <sql>document_id</sql>
                    <target_class>Document</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                    <jointype/>
                </field>
                <field id="document_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>document_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
            </fields>
            <methods/>
            <presentation>
                <details>
                    <items>
                        <item id="pnobject_id">
                            <rank>10</rank>
                        </item>
                        <item id="document_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </details>
                <search>
                    <items>
                        <item id="pnobject_id">
                            <rank>10</rank>
                        </item>
                        <item id="document_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="pnobject_id">
                            <rank>10</rank>
                        </item>
                        <item id="document_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="lnkPNObjectToTicket" _delta="define">
            <parent>cmdbAbstractObject</parent>
            <properties>
                <is_link>1</is_link>
                <category>bizmodel</category>
                <abstract>false</abstract>
                <key_type>autoincrement</key_type>
                <db_table>lnkpnobjecttoticket</db_table>
                <db_key_field>id</db_key_field>
                <db_final_class_field/>
                <naming>
                    <attributes>
                        <attribute id="pnobject_id"/>
                        <attribute id="ticket_ref"/>
                    </attributes>
                </naming>
                <icon/>
                <reconciliation>
                    <attributes>
                        <attribute id="pnobject_id"/>
                        <attribute id="ticket_id"/>
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="no_duplicate">
                        <attributes>
                            <attribute id="pnobject_id"/>
                            <attribute id="ticket_id"/>
                        </attributes>
                        <filter><![CDATA[]]></filter>
                        <disabled>false</disabled>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="pnobject_id" xsi:type="AttributeExternalKey">
                    <sql>pnobject_id</sql>
                    <target_class>PNObject</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                    <jointype/>
                </field>
                <field id="ticket_id" xsi:type="AttributeExternalKey">
                    <sql>ticket_id</sql>
                    <target_class>Ticket</target_class>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_AUTO</on_target_delete>
                </field>
                <field id="ticket_ref" xsi:type="AttributeExternalField">
                    <extkey_attcode>ticket_id</extkey_attcode>
                    <target_attcode>ref</target_attcode>
                </field>
                <field id="ticket_title" xsi:type="AttributeExternalField">
                    <extkey_attcode>ticket_id</extkey_attcode>
                    <target_attcode>title</target_attcode>
                </field>
            </fields>
            <methods/>
            <presentation>
                <details>
                    <items>
                        <item id="pnobject_id">
                            <rank>10</rank>
                        </item>
                        <item id="ticket_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </details>
                <search>
                    <items>
                        <item id="pnobject_id">
                            <rank>10</rank>
                        </item>
                        <item id="ticket_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="pnobject_id">
                            <rank>10</rank>
                        </item>
                        <item id="ticket_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </list>
            </presentation>
        </class>
        <class id="PNRange" _delta="define">
            <parent>PNObject</parent>
            <php_parent>
                <name>TeemIp\TeemIp\Extension\PhoneNumberManagement\Model\_PNRange</name>
                <file>src/Model/_PNRange.php</file>
            </php_parent>
            <properties>
                <comment/>
                <category>bizmodel,searchable,pnmgmt</category>
                <abstract>false</abstract>
                <key_type>autoincrement</key_type>
                <db_table>pnrange</db_table>
                <db_key_field>id</db_key_field>
                <db_final_class_field>finalclass</db_final_class_field>
                <naming>
                    <attributes>
                        <attribute id="name"/>
                    </attributes>
                </naming>
                <style>
                    <icon>asset/img/icons8-outgoing-call.svg</icon>
                </style>
                <reconciliation>
                    <attributes>
                        <attribute id="org_id"/>
                        <attribute id="firstnumber"/>
                        <attribute id="lastnumber"/>
                    </attributes>
                </reconciliation>
                <uniqueness_rules>
                    <rule id="no_duplicate_name">
                        <attributes>
                            <attribute id="org_id"/>
                            <attribute id="name"/>
                        </attributes>
                        <filter/>
                        <disabled>false</disabled>
                        <is_blocking>true</is_blocking>
                    </rule>
                    <rule id="no_duplicate_range">
                        <attributes>
                            <attribute id="org_id"/>
                            <attribute id="firstnumber"/>
                            <attribute id="lastnumber"/>
                        </attributes>
                        <filter/>
                        <disabled>false</disabled>
                        <is_blocking>true</is_blocking>
                    </rule>
                </uniqueness_rules>
            </properties>
            <fields>
                <field id="parent_org_id" xsi:type="AttributeExternalKey">
                    <filter/>
                    <dependencies/>
                    <sql>parent_org_id</sql>
                    <target_class>Organization</target_class>
                    <is_null_allowed>true</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                    <jointype/>
                </field>
                <field id="parent_org_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>parent_org_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="parent_id" xsi:type="AttributeHierarchicalKey">
                    <dependencies>
                        <attribute id="firstnumber"/>
                        <attribute id="lastnumber"/>
                        <attribute id="org_id"/>
                    </dependencies>
                    <sql>parent_id</sql>
                    <is_null_allowed>true</is_null_allowed>
                    <on_target_delete>DEL_MOVEUP</on_target_delete>
                    <filter><![CDATA[SELECT PNRange AS p WHERE p.org_id = :this->org_id]]></filter>
                    <default_value>null</default_value>
                </field>
                <field id="parent_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>parent_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="name" xsi:type="AttributeString">
                    <sql>name</sql>
                    <default_value/>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="firstnumber" xsi:type="AttributePhoneNumber">
                    <sql>firstnumber</sql>
                    <default_value/>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="lastnumber" xsi:type="AttributePhoneNumber">
                    <sql>lastnumber</sql>
                    <default_value/>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="occupancy" xsi:type="AttributePercentage">
                    <sql>occupancy</sql>
                    <default_value>0</default_value>
                    <is_null_allowed>true</is_null_allowed>
                </field>
                <field id="phonenumbers_list" xsi:type="AttributeLinkedSet">
                    <linked_class>PhoneNumber</linked_class>
                    <ext_key_to_me>pnrange_id</ext_key_to_me>
                    <edit_mode>none</edit_mode>
                </field>
            </fields>
            <event_listeners>
                <event_listener id="OnPNRangeComputeValuesRequestedByPhoneNumberMgmt">
                    <event>EVENT_DB_COMPUTE_VALUES</event>
                    <callback>OnPNRangeComputeValuesRequestedByPhoneNumberMgmt</callback>
                    <rank>100</rank>
                </event_listener>
                <event_listener id="OnPNRangeSetAttributesFlagsRequestedByPhoneNumberMgmt">
                    <event>EVENT_DB_SET_ATTRIBUTES_FLAGS</event>
                    <callback>OnPNRangeSetAttributesFlagsRequestedByPhoneNumberMgmt</callback>
                    <rank>100</rank>
                </event_listener>
                <event_listener id="OnPNRangeCheckToWriteRequestedByPhoneNumberMgmt">
                    <event>EVENT_DB_CHECK_TO_WRITE</event>
                    <callback>OnPNRangeCheckToWriteRequestedByPhoneNumberMgmt</callback>
                    <rank>110</rank>
                </event_listener>
                <event_listener id="OnPNRangeAfterWriteRequestedByPhoneNumberMgmt">
                    <event>EVENT_DB_AFTER_WRITE</event>
                    <callback>OnPNRangeAfterWriteRequestedByPhoneNumberMgmt</callback>
                    <rank>120</rank>
                </event_listener>
            </event_listeners>
            <methods/>
            <presentation>
                <details>
                    <items>
                        <item id="col:col1">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:Class:PNRange:baseinfo">
                                    <rank>10</rank>
                                    <items>
                                        <item id="org_id">
                                            <rank>10</rank>
                                        </item>
                                        <item id="name">
                                            <rank>20</rank>
                                        </item>
                                        <item id="status">
                                            <rank>30</rank>
                                        </item>
                                        <item id="comment">
                                            <rank>40</rank>
                                        </item>
                                        <item id="requestor_id">
                                            <rank>50</rank>
                                        </item>
                                        <item id="allocation_date">
                                            <rank>60</rank>
                                        </item>
                                        <item id="release_date">
                                            <rank>70</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col2">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:Class:PNRange:rangeinfo">
                                    <rank>10</rank>
                                    <items>
                                        <item id="fieldset:Class:PNRange:delegationinfo">
                                            <rank>10</rank>
                                            <items>
                                                <item id="parent_org_id">
                                                    <rank>10</rank>
                                                </item>
                                            </items>
                                        </item>
                                        <item id="fieldset:Class:PNRange:numberinginfo">
                                            <rank>20</rank>
                                            <items>
                                                <item id="parent_id">
                                                    <rank>10</rank>
                                                </item>
                                                <item id="firstnumber">
                                                    <rank>20</rank>
                                                </item>
                                                <item id="lastnumber">
                                                    <rank>30</rank>
                                                </item>
                                            </items>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="contacts_list">
                            <rank>30</rank>
                        </item>
                        <item id="documents_list">
                            <rank>40</rank>
                        </item>
                        <item id="phonenumbers_list">
                            <rank>50</rank>
                        </item>
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="name">
                            <rank>10</rank>
                        </item>
                        <item id="firstnumber">
                            <rank>20</rank>
                        </item>
                        <item id="lastnumber">
                            <rank>30</rank>
                        </item>
                        <item id="org_id">
                            <rank>40</rank>
                        </item>
                    </items>
                </default_search>
                <search>
                    <items>
                        <items>
                            <item id="name">
                                <rank>10</rank>
                            </item>
                            <item id="firstnumber">
                                <rank>20</rank>
                            </item>
                            <item id="lastnumber">
                                <rank>30</rank>
                            </item>
                            <item id="org_id">
                                <rank>40</rank>
                            </item>
                        </items>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="parent_id">
                            <rank>10</rank>
                        </item>
                        <item id="firstnumber">
                            <rank>20</rank>
                        </item>
                        <item id="lastnumber">
                            <rank>30</rank>
                        </item>
                        <item id="occupancy">
                            <rank>40</rank>
                        </item>
                        <item id="org_id">
                            <rank>50</rank>
                        </item>
                        <item id="allocation_date">
                            <rank>60</rank>
                        </item>
                    </items>
                </list>
                <summary>
                    <items>
                        <item id="parent_id">
                            <rank>10</rank>
                        </item>
                        <item id="firstnumber">
                            <rank>20</rank>
                        </item>
                        <item id="lastnumber">
                            <rank>30</rank>
                        </item>
                    </items>
                </summary>
            </presentation>
        </class>
        <class id="PhoneNumber" _delta="define">
            <parent>PNObject</parent>
            <php_parent>
                <name>TeemIp\TeemIp\Extension\PhoneNumberManagement\Model\_PhoneNumber</name>
                <file>src/Model/_PhoneNumber.php</file>
            </php_parent>
            <properties>
                <comment/>
                <category>bizmodel,searchable,pnmgmt</category>
                <abstract>false</abstract>
                <key_type>autoincrement</key_type>
                <db_table>phonenumber</db_table>
                <db_key_field>id</db_key_field>
                <db_final_class_field>finalclass</db_final_class_field>
                <naming>
                    <attributes>
                        <attribute id="number"/>
                    </attributes>
                </naming>
                <style>
                    <icon>asset/img/icons8-phone.svg</icon>
                </style>
                <reconciliation>
                    <attributes>
                        <attribute id="org_id"/>
                        <attribute id="number"/>
                    </attributes>
                </reconciliation>
            </properties>
            <fields>
                <field id="pnrange_id" xsi:type="AttributeExternalKey">
                    <sql>pnrange_id</sql>
                    <target_class>PNRange</target_class>
                    <filter><![CDATA[SELECT PNRange AS p WHERE p.org_id = :this->org_id]]></filter>
                    <dependencies>
                        <attribute id="org_id"/>
                    </dependencies>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                    <jointype/>
                </field>
                <field id="pnrange_name" xsi:type="AttributeExternalField">
                    <extkey_attcode>pnrange_id</extkey_attcode>
                    <target_attcode>name</target_attcode>
                </field>
                <field id="number" xsi:type="AttributePhoneNumber">
                    <sql>number</sql>
                    <default_value/>
                    <is_null_allowed>false</is_null_allowed>
                </field>
                <field id="pnextensions_list" xsi:type="AttributeLinkedSet">
                    <linked_class>PNExtension</linked_class>
                    <ext_key_to_me>phonenumber_id</ext_key_to_me>
                    <edit_mode>none</edit_mode>
                </field>
            </fields>
            <event_listeners>
                <event_listener id="OnPhoneNumberAfterWriteRequestedByPNRange">
                    <event>EVENT_DB_AFTER_WRITE</event>
                    <callback>OnPhoneNumberAfterWriteRequestedByPNRange</callback>
                    <rank>100</rank>
                </event_listener>
                <event_listener id="OnPhoneNumberAfterDeleteRequestedByPNRange">
                    <event>EVENT_DB_AFTER_DELETE</event>
                    <callback>OnPhoneNumberAfterDeleteRequestedByPNRange</callback>
                    <rank>110</rank>
                </event_listener>
            </event_listeners>
            <methods/>
            <presentation>
                <details>
                    <items>
                        <item id="col:col1">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:Class:PhoneNumber:baseinfo">
                                    <rank>10</rank>
                                    <items>
                                        <item id="org_id">
                                            <rank>10</rank>
                                        </item>
                                        <item id="status">
                                            <rank>20</rank>
                                        </item>
                                        <item id="comment">
                                            <rank>30</rank>
                                        </item>
                                        <item id="requestor_id">
                                            <rank>40</rank>
                                        </item>
                                        <item id="allocation_date">
                                            <rank>50</rank>
                                        </item>
                                        <item id="release_date">
                                            <rank>60</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col2">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:Class:PhoneNumber:numberinfo">
                                    <rank>10</rank>
                                    <items>
                                        <item id="pnrange_id">
                                            <rank>10</rank>
                                        </item>
                                        <item id="number">
                                            <rank>20</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="contacts_list">
                            <rank>30</rank>
                        </item>
                        <item id="documents_list">
                            <rank>40</rank>
                        </item>
                        <item id="pnextensions_list">
                            <rank>50</rank>
                        </item>
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="number">
                            <rank>10</rank>
                        </item>
                        <item id="pnrange_id">
                            <rank>20</rank>
                        </item>
                        <item id="org_id">
                            <rank>30</rank>
                        </item>
                    </items>
                </default_search>
                <search>
                    <items>
                        <items>
                            <item id="number">
                                <rank>10</rank>
                            </item>
                            <item id="pnrange_id">
                                <rank>20</rank>
                            </item>
                            <item id="org_id">
                                <rank>30</rank>
                            </item>
                        </items>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="status">
                            <rank>10</rank>
                        </item>
                        <item id="pnrange_id">
                            <rank>20</rank>
                        </item>
                        <item id="org_id">
                            <rank>30</rank>
                        </item>
                        <item id="allocation_date">
                            <rank>40</rank>
                        </item>
                    </items>
                </list>
                <summary>
                    <items>
                        <item id="status">
                            <rank>10</rank>
                        </item>
                        <item id="pnrange_id">
                            <rank>20</rank>
                        </item>
                    </items>
                </summary>
            </presentation>
        </class>
        <class id="PNExtension" _delta="define">
            <parent>PNObject</parent>
            <php_parent>
                <name>TeemIp\TeemIp\Extension\PhoneNumberManagement\Model\_PNExtension</name>
                <file>src/Model/_PNExtension.php</file>
            </php_parent>
            <properties>
                <comment/>
                <category>bizmodel,searchable,pnmgmt</category>
                <abstract>false</abstract>
                <key_type>autoincrement</key_type>
                <db_table>PNExtension</db_table>
                <db_key_field>id</db_key_field>
                <db_final_class_field>finalclass</db_final_class_field>
                <naming>
                    <attributes>
                        <attribute id="phonenumber_number"/>
                        <attribute id="code"/>
                    </attributes>
                </naming>
                <style>
                    <icon>asset/img/icons8-number-pad.svg</icon>
                </style>
                <reconciliation>
                    <attributes>
                        <attribute id="org_id"/>
                        <attribute id="phonenumber_id"/>
                        <attribute id="code"/>
                    </attributes>
                </reconciliation>
            </properties>
            <fields>
                <field id="phonenumber_id" xsi:type="AttributeExternalKey">
                    <sql>phonenumber_id</sql>
                    <target_class>PhoneNumber</target_class>
                    <filter><![CDATA[SELECT PhoneNumber AS p WHERE p.org_id = :this->org_id]]></filter>
                    <dependencies>
                        <attribute id="org_id"/>
                    </dependencies>
                    <is_null_allowed>false</is_null_allowed>
                    <on_target_delete>DEL_MANUAL</on_target_delete>
                    <jointype/>
                </field>
                <field id="phonenumber_number" xsi:type="AttributeExternalField">
                    <extkey_attcode>phonenumber_id</extkey_attcode>
                    <target_attcode>number</target_attcode>
                </field>
                <field id="code" xsi:type="AttributeString">
                    <sql>code</sql>
                    <default_value/>
                    <is_null_allowed>false</is_null_allowed>
                </field>
            </fields>
            <methods/>
            <presentation>
                <details>
                    <items>
                        <item id="col:col1">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:Class:PNExtension:baseinfo">
                                    <rank>10</rank>
                                    <items>
                                        <item id="org_id">
                                            <rank>20</rank>
                                        </item>
                                        <item id="status">
                                            <rank>30</rank>
                                        </item>
                                        <item id="comment">
                                            <rank>40</rank>
                                        </item>
                                        <item id="requestor_id">
                                            <rank>50</rank>
                                        </item>
                                        <item id="allocation_date">
                                            <rank>60</rank>
                                        </item>
                                        <item id="release_date">
                                            <rank>70</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="col:col2">
                            <rank>10</rank>
                            <items>
                                <item id="fieldset:Class:PNExtension:numberinfo">
                                    <rank>10</rank>
                                    <items>
                                        <item id="phonenumber_id">
                                            <rank>10</rank>
                                        </item>
                                        <item id="code">
                                            <rank>20</rank>
                                        </item>
                                    </items>
                                </item>
                            </items>
                        </item>
                        <item id="contacts_list">
                            <rank>30</rank>
                        </item>
                        <item id="documents_list">
                            <rank>40</rank>
                        </item>
                    </items>
                </details>
                <default_search>
                    <items>
                        <item id="number">
                            <rank>10</rank>
                        </item>
                        <item id="phonenumber_id">
                            <rank>20</rank>
                        </item>
                        <item id="org_id">
                            <rank>30</rank>
                        </item>
                    </items>
                </default_search>
                <search>
                    <items>
                        <items>
                            <item id="number">
                                <rank>10</rank>
                            </item>
                            <item id="phonenumber_id">
                                <rank>20</rank>
                            </item>
                            <item id="org_id">
                                <rank>30</rank>
                            </item>
                        </items>
                    </items>
                </search>
                <list>
                    <items>
                        <item id="phonenumber_id">
                            <rank>10</rank>
                        </item>
                        <item id="org_id">
                            <rank>20</rank>
                        </item>
                        <item id="allocation_date">
                            <rank>30</rank>
                        </item>
                    </items>
                </list>
                <summary>
                    <items>
                        <item id="phonenumber_id">
                            <rank>10</rank>
                        </item>
                    </items>
                </summary>
            </presentation>
        </class>
    </classes>
    <menus>
        <menu id="TelephonyManagement" xsi:type="MenuGroup" _delta="define">
            <rank>32</rank>
            <style>
                <decoration_classes>fa fa-phone</decoration_classes>
            </style>
        </menu>
        <menu id="TelephonySpace" xsi:type="DashboardMenuNode" _delta="define">
            <rank>10</rank>
            <parent>TelephonyManagement</parent>
            <definition>
                <layout>DashboardLayoutOneCol</layout>
                <title/>
                <cells>
                    <cell id="teemip-100">
                        <rank>10</rank>
                        <dashlets>
                            <dashlet id="teemip-110" xsi:type="DashletHeaderStatic">
                                <rank>10</rank>
                                <title>Menu:TelephonySpace:PNObjects</title>
                                <icon>teemip-phone-number-mgmt/asset/img/icons8-internet-folder-48.png</icon>
                            </dashlet>
                            <dashlet id="teemip-120" xsi:type="DashletBadge">
                                <rank>20</rank>
                                <class>PNRange</class>
                            </dashlet>
                            <dashlet id="teemip-130" xsi:type="DashletBadge">
                                <rank>30</rank>
                                <class>PhoneNumber</class>
                            </dashlet>
                            <dashlet id="teemip-140" xsi:type="DashletBadge">
                                <rank>40</rank>
                                <class>PNExtension</class>
                            </dashlet>
                        </dashlets>
                    </cell>
                </cells>
            </definition>
        </menu>
        <menu id="NewPNObject" xsi:type="NewObjectMenuNode" _delta="define">
            <rank>20</rank>
            <parent>TelephonyManagement</parent>
            <class>PNObject</class>
        </menu>
        <menu id="SearchPNObject" xsi:type="SearchMenuNode" _delta="define">
            <rank>30</rank>
            <parent>TelephonyManagement</parent>
            <class>PNObject</class>
        </menu>
        <menu id="PNRange" xsi:type="OQLMenuNode" _delta="define">
            <rank>40</rank>
            <parent>TelephonyManagement</parent>
            <oql>SELECT PNRange</oql>
            <do_search>1</do_search>
            <auto_reload>fast</auto_reload>
        </menu>
        <menu id="PhoneNumber" xsi:type="OQLMenuNode" _delta="define">
            <rank>50</rank>
            <parent>TelephonyManagement</parent>
            <oql>SELECT PhoneNumber</oql>
            <do_search>1</do_search>
            <auto_reload>fast</auto_reload>
        </menu>
        <menu id="PNExtension" xsi:type="OQLMenuNode" _delta="define">
            <rank>60</rank>
            <parent>TelephonyManagement</parent>
            <oql>SELECT PNExtension</oql>
            <do_search>1</do_search>
            <auto_reload>fast</auto_reload>
        </menu>
    </menus>
    <user_rights>
        <groups>
            <group id="PNObject" _delta="define">
                <classes>
                    <class id="PNObject"/>
                </classes>
            </group>
            <group id="LnkToPNObject" _delta="define">
                <classes>
                    <class id="lnkContactToPNObject"/>
                    <class id="lnkDocToPNObject"/>
                    <class id="lnkPNObjectToTicket"/>
                </classes>
            </group>
        </groups>
        <profiles>
            <profile id="5328" _delta="define">
                <name>Phone Numbers Manager</name>
                <description>Person in charge of the phone numbers space</description>
                <groups>
                    <group id="PNObject">
                        <actions>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="LnkToPNObject">
                        <actions>
                            <action id="action:write">allow</action>
                            <action id="action:bulk write">allow</action>
                            <action id="action:delete">allow</action>
                            <action id="action:bulk delete">allow</action>
                        </actions>
                    </group>
                    <group id="*">
                        <actions>
                            <action id="action:read">allow</action>
                            <action id="action:bulk read">allow</action>
                        </actions>
                    </group>
                </groups>
            </profile>
        </profiles>
    </user_rights>
</itop_design>
